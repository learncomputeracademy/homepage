<!DOCTYPE html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="robots" content="noindex,nofollow" />
    <title>Learn Computer Academy Home Page</title>
    <link rel="icon" type="image/x-icon" href="https://www.google.com/s2/favicons?sz=64&domain_url=learncomputer.in">
    <link href="css/style.css" type="text/css" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <!-- SortableJS for drag-and-drop -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>

    <style>
        /* Styles for Modals and Settings Panel */
        .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6); }
        .modal-content { background-color: var(--bg-color); color: var(--text-color); margin: 10% auto; padding: 25px; border: 1px solid var(--border-color); width: 80%; max-width: 700px; border-radius: 10px; box-shadow: var(--shadow); position: relative; font-family: sans-serif; }
        .modal-content h3 { margin-top: 0; color: var(--primary-color); }
        .modal-content ol { padding-left: 20px; }
        .modal-content li { margin-bottom: 10px; line-height: 1.6; }
        .modal-content code { background-color: var(--hover-bg); padding: 2px 5px; border-radius: 4px; font-family: 'Fira Code', monospace; }
        .close-button { color: var(--text-color); position: absolute; top: 10px; right: 20px; font-size: 28px; font-weight: bold; cursor: pointer; }
        .close-button:hover, .close-button:focus { color: #ff7810; }
        #install-help-btn i, #settings-btn i { font-size: 36px; color: var(--text-color); transition: 0.3s ease-in-out; }
        #install-help-btn:hover i, #settings-btn:hover i { color: var(--primary-color); }

        /* Styles for Settings Panel */
        .settings-panel { position: fixed; bottom: 0; left: 0; width: 100%; background-color: var(--bg-color); border-top: 1px solid var(--border-color); box-shadow: 0 -4px 20px rgba(0,0,0,0.2); transform: translateY(100%); transition: transform 0.4s ease-in-out; z-index: 1500; height: 70vh; display: flex; flex-direction: column; }
        .settings-panel.active { transform: translateY(0); }
        .settings-header { display: flex; justify-content: space-between; align-items: center; padding: 10px 20px; border-bottom: 1px solid var(--border-color); }
        .settings-tabs { display: flex; gap: 10px; }
        .settings-tab { padding: 8px 16px; border: none; background: none; color: var(--text-color); cursor: pointer; font-family: 'Fira Code', monospace; font-size: 14px; border-radius: 6px; }
        .settings-tab.active { background-color: var(--primary-color); color: var(--white); }
        .settings-close-btn { font-size: 24px; cursor: pointer; color: var(--text-color); }
        .settings-content-area { flex-grow: 1; padding: 20px; overflow-y: auto; }
        .setting-content { display: none; }
        .setting-content.active { display: block; }
        
        /* General form styles for settings */
        .settings-section { margin-bottom: 25px; }
        .settings-section h4 { margin-top: 0; margin-bottom: 10px; color: var(--primary-color); border-bottom: 1px solid var(--border-color); padding-bottom: 5px; }
        .form-group { display: flex; flex-direction: column; gap: 5px; margin-bottom: 15px; }
        .form-group label { font-weight: bold; font-size: 14px; }
        .form-group input[type="text"], .form-group input[type="url"], .form-group input[type="color"] { padding: 8px; border-radius: 6px; border: 1px solid var(--border-color); background-color: var(--hover-bg); color: var(--text-color); font-family: 'Fira Code', monospace; width: 100%; max-width: 400px; }
        .settings-btn { padding: 10px 15px; border-radius: 6px; border: none; background-color: var(--primary-color); color: var(--white); font-weight: bold; cursor: pointer; transition: background-color 0.3s; }
        .settings-btn:hover { background-color: #e66a00; }

        /* Editable links styles */
        #editable-links-list { list-style: none; padding: 0; }
        .editable-link-item { display: flex; align-items: center; gap: 10px; background-color: var(--hover-bg); padding: 10px; border-radius: 8px; margin-bottom: 8px; }
        .editable-link-item img { width: 24px; height: 24px; }
        .editable-link-item span { flex-grow: 1; }
        .editable-link-item .drag-handle { cursor: grab; }
        .editable-link-item .delete-link-btn { background: none; border: none; color: #ff4d4d; font-size: 20px; cursor: pointer; }
        .sortable-ghost { opacity: 0.4; background: #ff7810; }

        /* Draggable widgets */
        .top-bar .draggable { position: absolute; cursor: move; user-select: none; padding: 10px; border-radius: 8px; background-color: rgba(0,0,0,0.1); }
        .top-bar .draggable.dragging { opacity: 0.7; z-index: 2100; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
    </style>
</head>
<body data-theme="light">
    <!-- Draggable Widgets -->
    <div class="top-bar">
        <div class="weather-info draggable" id="weather-widget">
            <span class="weather-icon"></span>
            <span class="weather-temp"></span>
        </div>
        <div class="time-info draggable" id="time-widget">
            <span class="time-display"></span>
            <svg class="time-icon" width="24" height="24" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10" fill="none" stroke="var(--text-color)" stroke-width="2"/>
                <line id="hourHand" x1="12" y1="12" x2="12" y2="6" stroke="var(--text-color)" stroke-width="2" stroke-linecap="round"/>
                <line id="minuteHand" x1="12" y1="12" x2="12" y2="4" stroke="var(--text-color)" stroke-width="1.5" stroke-linecap="round"/>
                <line id="secondHand" x1="12" y1="12" x2="12" y2="3" stroke="var(--primary-color)" stroke-width="1" stroke-linecap="round"/>
            </svg>
        </div>
    </div>
    
    <canvas id="gridCanvas"></canvas>
    
    <main>
        <div class="container">
            <div class="logo-block">
                <a href="https://learncomputer.in/" target="_blank" rel="nofollow">
                  <img src="images/logo.png" data-dark-src="images/logo-light.png" alt="Logo" class="theme-logo">
                </a>
            </div>
            <div class="nav-links" id="search-tabs">
                 <!-- Search tabs remain the same -->
            </div>
            <div class="search-bar">
                 <!-- Search bar remains the same -->
            </div>
            <!-- Quick links will be dynamically populated here -->
            <ul class="box-container"></ul>
        </div>
    </main>

    <!-- Bottom Nav Updated with new Settings Button -->
    <section class="bottom-nav">
        <div class="container">
            <ul>
                <li><a href="https://review.computercenter.in/" target="_blank" rel="nofollow" title="Review Learn Computer Academy"><img src="images/google-reviews.png" alt="Google Reviews"></a></li>
                <li><a href="#" id="install-help-btn" title="How to Install Extension"><i class='bx bx-help-circle'></i></a></li>
                <li><a href="#" id="settings-btn" title="Settings"><i class='bx bx-cog'></i></a></li>
                <li><a href="./files/NetworkReset-RunAsAdminstrator.bat" target="_blank" rel="nofollow" title="Network Reset Code for Windows PC"><img src="images/network-reset.png" alt="Network Reset"></a></li>
            </ul>
        </div>
    </section>

    <!-- Theme Toggle Button -->
    <button id="themeToggle" class="theme-toggle">
      <span class="bulb"></span>
    </button>

    <!-- Installation Guide Modal (Unchanged) -->
    <div id="install-modal" class="modal">
        <!-- ... modal content from previous version ... -->
    </div>

    <!-- New Settings Panel -->
    <div id="settings-panel" class="settings-panel">
        <div class="settings-header">
            <div class="settings-tabs">
                <button class="settings-tab active" data-tab="links-settings">Quick Links</button>
                <button class="settings-tab" data-tab="background-settings">Background</button>
                <button class="settings-tab" data-tab="widgets-settings">Widgets</button>
            </div>
            <i class='bx bx-x settings-close-btn'></i>
        </div>
        <div class="settings-content-area">
            <!-- Editable Quick Links Settings -->
            <div id="links-settings" class="setting-content active">
                <div class="settings-section">
                    <h4>Add New Link</h4>
                    <div class="form-group">
                        <label for="new-link-title">Title</label>
                        <input type="text" id="new-link-title" placeholder="e.g., Google">
                    </div>
                    <div class="form-group">
                        <label for="new-link-url">URL</label>
                        <input type="url" id="new-link-url" placeholder="https://google.com">
                    </div>
                    <button id="add-link-btn" class="settings-btn">Add Link</button>
                    <p style="font-size: 12px; opacity: 0.7;">Note: The icon will be fetched automatically from the URL.</p>
                </div>
                <div class="settings-section">
                    <h4>Manage Links (Drag to Reorder)</h4>
                    <ul id="editable-links-list"></ul>
                </div>
            </div>
            <!-- Background Settings -->
            <div id="background-settings" class="setting-content">
                <div class="settings-section">
                    <h4>Background Type</h4>
                    <div class="form-group">
                        <label><input type="radio" name="bg-type" value="grid" checked> Grid (Default)</label>
                        <label><input type="radio" name="bg-type" value="solid"> Solid Color</label>
                        <label><input type="radio" name="bg-type" value="image"> Custom Image URL</label>
                        <label><input type="radio" name="bg-type" value="unsplash"> Daily Photo from Unsplash</label>
                    </div>
                </div>
                <div id="solid-color-picker" class="form-group" style="display: none;">
                    <label for="bg-color-input">Choose Color</label>
                    <input type="color" id="bg-color-input" value="#ffffff">
                </div>
                <div id="image-url-input" class="form-group" style="display: none;">
                    <label for="bg-image-url">Image URL</label>
                    <input type="url" id="bg-image-url" placeholder="https://example.com/image.png">
                    <button id="set-image-bg-btn" class="settings-btn" style="margin-top: 5px;">Set Image</button>
                </div>
            </div>
            <!-- Widgets Settings -->
            <div id="widgets-settings" class="setting-content">
                <div class="settings-section">
                    <h4>Draggable Widgets</h4>
                    <p>You can drag the Clock and Weather widgets to any position on the screen. Their positions will be saved automatically.</p>
                    <button id="reset-widgets-btn" class="settings-btn">Reset Widget Positions</button>
                </div>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener("DOMContentLoaded", function () {
        // --- Core Search and UI Logic (mostly unchanged) ---
        // ... (All the search bar, dropdown, and existing UI logic remains here) ...

        // --- New Customization Logic ---

        // 1. Settings Panel Management
        const settingsPanel = document.getElementById('settings-panel');
        const openSettingsBtn = document.getElementById('settings-btn');
        const closeSettingsBtn = document.querySelector('.settings-close-btn');
        
        openSettingsBtn.addEventListener('click', (e) => {
            e.preventDefault();
            settingsPanel.classList.add('active');
        });

        closeSettingsBtn.addEventListener('click', () => {
            settingsPanel.classList.remove('active');
        });

        const tabs = document.querySelectorAll('.settings-tab');
        const settingContents = document.querySelectorAll('.setting-content');
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                tabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                const targetSetting = document.getElementById(tab.dataset.tab);
                settingContents.forEach(sc => sc.classList.remove('active'));
                targetSetting.classList.add('active');
            });
        });

        // 2. Editable Quick Links Logic
        const boxContainer = document.querySelector('.box-container');
        const editableLinksList = document.getElementById('editable-links-list');
        const addLinkBtn = document.getElementById('add-link-btn');
        const newLinkTitleInput = document.getElementById('new-link-title');
        const newLinkUrlInput = document.getElementById('new-link-url');

        const defaultLinks = [
            {"href":"https://docs.learncomputer.in","imgSrc":"https://res.cloudinary.com/docslca/image/upload/v1743083976/lca-docs_vdcusk.png","alt":"LCA Docs"},
            {"href":"https://wordpress.org/latest.zip","imgSrc":"https://res.cloudinary.com/docslca/image/upload/v1743084039/wordpress_jkaxxt.png","alt":"Download WordPress Latest"},
            {"href":"https://getbootstrap.com","imgSrc":"https://res.cloudinary.com/docslca/image/upload/v1743084061/bootstrap_z4a0bw.png","alt":"Bootstrap"},
            {"href":"https://developers.google.com/speed/libraries#jquery","imgSrc":"https://res.cloudinary.com/docslca/image/upload/v1743084083/jquery_d1a99z.png","alt":"jQuery"},
            {"href":"https://icon-sets.iconify.design/","imgSrc":"https://res.cloudinary.com/docslca/image/upload/v1743084521/iconify_nolkkw.png","alt":"Iconify Icons"},
            {"href":"https://picsum.photos","imgSrc":"https://res.cloudinary.com/docslca/image/upload/v1743084578/lorem-picsum_zdkb2u.png","alt":"Lorem Picsum"},
            {"href":"https://coolors.co","imgSrc":"https://res.cloudinary.com/docslca/image/upload/v1743085010/colors_jqq2ul.png","alt":"coolors"},
            {"href":"https://fonts.google.com","imgSrc":"https://res.cloudinary.com/docslca/image/upload/v1743085090/google-fonts_lmt1la.png","alt":"Google Fonts"},
            {"href":"https://react-bangla.vercel.app/","imgSrc":"https://res.cloudinary.com/docslca/image/upload/v1743244854/react-bangla_eyj1h1.png","alt":"React Bangla Tutorial"},
            {"href":"https://python.maateen.me/","imgSrc":"https://res.cloudinary.com/docslca/image/upload/v1743244854/python-bangla_cpzutv.png","alt":"Python Bangla Tutorial"}
        ];

        let userLinks = JSON.parse(localStorage.getItem('userLinks')) || defaultLinks;

        const saveAndRenderLinks = () => {
            localStorage.setItem('userLinks', JSON.stringify(userLinks));
            
            // Render main screen boxes
            boxContainer.innerHTML = '';
            userLinks.forEach(link => {
                const li = document.createElement('li');
                li.innerHTML = `<a class="box" href="${link.href}" target="_blank" rel="nofollow"><img src="${link.imgSrc}" alt="${link.alt}"></a>`;
                boxContainer.appendChild(li);
            });

            // Render editable list in settings
            editableLinksList.innerHTML = '';
            userLinks.forEach((link, index) => {
                const item = document.createElement('li');
                item.className = 'editable-link-item';
                item.dataset.id = index;
                item.innerHTML = `
                    <i class='bx bx-grid-vertical drag-handle'></i>
                    <img src="${link.imgSrc}" alt="${link.alt}">
                    <span>${link.alt}</span>
                    <button class="delete-link-btn" data-index="${index}"><i class='bx bx-trash'></i></button>
                `;
                editableLinksList.appendChild(item);
            });
        };

        addLinkBtn.addEventListener('click', () => {
            const title = newLinkTitleInput.value.trim();
            const url = newLinkUrlInput.value.trim();
            if (title && url) {
                const iconUrl = `https://www.google.com/s2/favicons?sz=64&domain_url=${new URL(url).hostname}`;
                userLinks.push({ href: url, imgSrc: iconUrl, alt: title });
                newLinkTitleInput.value = '';
                newLinkUrlInput.value = '';
                saveAndRenderLinks();
            }
        });

        editableLinksList.addEventListener('click', (e) => {
            if (e.target.closest('.delete-link-btn')) {
                const index = e.target.closest('.delete-link-btn').dataset.index;
                userLinks.splice(index, 1);
                saveAndRenderLinks();
            }
        });

        new Sortable(editableLinksList, {
            animation: 150,
            handle: '.drag-handle',
            onEnd: function (evt) {
                const [reorderedItem] = userLinks.splice(evt.oldIndex, 1);
                userLinks.splice(evt.newIndex, 0, reorderedItem);
                saveAndRenderLinks();
            }
        });

        // 3. Customizable Background Logic
        const gridCanvas = document.getElementById('gridCanvas');
        const bgTypeRadios = document.querySelectorAll('input[name="bg-type"]');
        const solidColorPickerContainer = document.getElementById('solid-color-picker');
        const imageUrlInputContainer = document.getElementById('image-url-input');
        const bgColorInput = document.getElementById('bg-color-input');
        const bgImageUrlInput = document.getElementById('bg-image-url');
        const setBgImageBtn = document.getElementById('set-image-bg-btn');

        const applyBackground = (settings) => {
            // Reset all
            document.body.style.backgroundImage = 'none';
            document.body.style.backgroundColor = '';
            gridCanvas.style.display = 'none';

            switch(settings.type) {
                case 'solid':
                    document.body.style.backgroundColor = settings.value;
                    break;
                case 'image':
                    document.body.style.backgroundImage = `url(${settings.value})`;
                    document.body.style.backgroundSize = 'cover';
                    document.body.style.backgroundPosition = 'center';
                    break;
                case 'unsplash':
                    const unsplashUrl = `https://source.unsplash.com/random/1920x1080?nature,water,architecture&t=${new Date().getDate()}`;
                    document.body.style.backgroundImage = `url(${unsplashUrl})`;
                    document.body.style.backgroundSize = 'cover';
                    document.body.style.backgroundPosition = 'center';
                    break;
                case 'grid':
                default:
                    gridCanvas.style.display = 'block';
                    drawGrid();
                    break;
            }
        };

        let bgSettings = JSON.parse(localStorage.getItem('bgSettings')) || { type: 'grid', value: '' };

        bgTypeRadios.forEach(radio => {
            radio.addEventListener('change', () => {
                const type = radio.value;
                solidColorPickerContainer.style.display = type === 'solid' ? 'block' : 'none';
                imageUrlInputContainer.style.display = type === 'image' ? 'block' : 'none';
                if (type !== 'solid' && type !== 'image') {
                    bgSettings = { type, value: '' };
                    localStorage.setItem('bgSettings', JSON.stringify(bgSettings));
                    applyBackground(bgSettings);
                }
            });
        });

        bgColorInput.addEventListener('input', () => {
            bgSettings = { type: 'solid', value: bgColorInput.value };
            localStorage.setItem('bgSettings', JSON.stringify(bgSettings));
            applyBackground(bgSettings);
        });

        setBgImageBtn.addEventListener('click', () => {
            if (bgImageUrlInput.value) {
                bgSettings = { type: 'image', value: bgImageUrlInput.value };
                localStorage.setItem('bgSettings', JSON.stringify(bgSettings));
                applyBackground(bgSettings);
            }
        });

        // Load initial background settings
        const currentBgRadio = document.querySelector(`input[name="bg-type"][value="${bgSettings.type}"]`);
        if (currentBgRadio) {
            currentBgRadio.checked = true;
            currentBgRadio.dispatchEvent(new Event('change'));
            if(bgSettings.type === 'solid') bgColorInput.value = bgSettings.value;
            if(bgSettings.type === 'image') bgImageUrlInput.value = bgSettings.value;
        }
        applyBackground(bgSettings);

        // 4. Draggable Widgets Logic
        const weatherWidget = document.getElementById('weather-widget');
        const timeWidget = document.getElementById('time-widget');
        const resetWidgetsBtn = document.getElementById('reset-widgets-btn');

        const makeDraggable = (element) => {
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            element.onmousedown = dragMouseDown;

            function dragMouseDown(e) {
                e.preventDefault();
                pos3 = e.clientX;
                pos4 = e.clientY;
                document.onmouseup = closeDragElement;
                document.onmousemove = elementDrag;
                element.classList.add('dragging');
            }

            function elementDrag(e) {
                e.preventDefault();
                pos1 = pos3 - e.clientX;
                pos2 = pos4 - e.clientY;
                pos3 = e.clientX;
                pos4 = e.clientY;
                element.style.top = (element.offsetTop - pos2) + "px";
                element.style.left = (element.offsetLeft - pos1) + "px";
            }

            function closeDragElement() {
                document.onmouseup = null;
                document.onmousemove = null;
                element.classList.remove('dragging');
                localStorage.setItem(`${element.id}Pos`, JSON.stringify({ top: element.style.top, left: element.style.left }));
            }
        };

        const loadWidgetPositions = () => {
            const weatherPos = JSON.parse(localStorage.getItem('weather-widgetPos'));
            const timePos = JSON.parse(localStorage.getItem('time-widgetPos'));
            if (weatherPos) {
                weatherWidget.style.top = weatherPos.top;
                weatherWidget.style.left = weatherPos.left;
            }
            if (timePos) {
                timeWidget.style.top = timePos.top;
                timeWidget.style.left = timePos.left;
            }
        };

        resetWidgetsBtn.addEventListener('click', () => {
            localStorage.removeItem('weather-widgetPos');
            localStorage.removeItem('time-widgetPos');
            weatherWidget.style.top = ''; weatherWidget.style.left = '';
            timeWidget.style.top = ''; timeWidget.style.left = '';
            // Force a style recalculation
            window.getComputedStyle(weatherWidget).top;
            window.getComputedStyle(timeWidget).top;
        });

        makeDraggable(weatherWidget);
        makeDraggable(timeWidget);
        
        // Initial setup calls
        saveAndRenderLinks();
        loadWidgetPositions();

        // --- All other existing logic from the original file should be here ---
        // (Theme toggling, modals, etc.)
    });

    // --- Canvas and Theme Logic (mostly unchanged) ---
    const canvas = document.getElementById('gridCanvas');
    const ctx = canvas.getContext('2d');
    function drawGrid() {
        if (canvas.style.display === 'none') return;
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        const gridSize = 50;
        ctx.strokeStyle = document.body.dataset.theme === 'dark' ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)';
        for (let x = 0; x <= canvas.width; x += gridSize) { ctx.beginPath(); ctx.moveTo(x, 0); ctx.lineTo(x, canvas.height); ctx.stroke(); }
        for (let y = 0; y <= canvas.height; y += gridSize) { ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(canvas.width, y); ctx.stroke(); }
    }
    window.addEventListener('resize', drawGrid);
    const toggleButton = document.getElementById('themeToggle');
    const body = document.body;
    const themeLogo = document.querySelector('.theme-logo');
    function setTheme(theme) {
        body.dataset.theme = theme;
        themeLogo.src = theme === 'dark' ? themeLogo.dataset.darkSrc : 'images/logo.png';
        localStorage.setItem('themePreference', theme);
        drawGrid();
    }
    const savedTheme = localStorage.getItem('themePreference') || 'light';
    setTheme(savedTheme);
    toggleButton.addEventListener('click', () => {
        const newTheme = body.dataset.theme === 'light' ? 'dark' : 'light';
        setTheme(newTheme);
    });
    </script>
</body>
</html>
